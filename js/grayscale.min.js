/*!
 * Start Bootstrap - Grayscale v5.0.1 (https://startbootstrap.com/template-overviews/grayscale)
 * Copyright 2013-2018 Start Bootstrap
 * Licensed under MIT (https://github.com/BlackrockDigital/startbootstrap-grayscale/blob/master/LICENSE)
 */
!function(a){"use strict";var n,t,e=location.href;-1!=e.indexOf("#success")?function(){f();var e=function(e,t){t||(t=window.location.href);e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?n[2]:"":null}("token"),t=sessionStorage.getItem(e);if(null!=t&&null!=t&&0<t.length){var n=JSON.parse(t);s(n),m(),a("#modalOrderComplete").modal("show")}}():-1!=e.indexOf("#failure")?a("#modalFailure").modal("show"):-1!=e.indexOf("#cancelled")&&a("#modalCancelled").modal("show"),a("#serviceCharge").text(5),a('a.js-scroll-trigger[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var e=a(this.hash);if((e=e.length?e:a("[name="+this.hash.slice(1)+"]")).length)return a("html, body").animate({scrollTop:e.offset().top-70},1e3,"easeInOutExpo"),!1}}),a(".js-scroll-trigger").click(function(){a(".navbar-collapse").collapse("hide")}),a("body").scrollspy({target:"#mainNav",offset:100});var r=function(){100<a("#mainNav").offset().top?a("#mainNav").addClass("navbar-shrink"):a("#mainNav").removeClass("navbar-shrink")};function o(){if(c(n)){var e=a("#amount").val();c(e)&&0<e-5?(t=Math.round((e-5)*n),a("#amountHelp").text("After $5 service charge, $"+i(e-5)+" @ Rs."+n+" will be Rs."+l(t)+".")):a("#amountHelp").text("Today's exchange rate is Rs. "+n+" for one aussie dollar.")}}function i(e){return c(e)?e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):null}function l(e){if(!c(e))return null;for(var t="",n=e.toString().split("."),a=n[0].length-1;0<=a;a--)0<t.length&&t.length%3==0&&(t=","+t),t=n[0][a]+t;return 1<n.length&&(t=t+"."+n[1]),t}function c(e){return!isNaN(parseFloat(e))&&!isNaN(e-0)}function s(e){a(".reviewAmount").text("$"+i(e.Amount)),a(".reviewServiceCharge").text("$"+e.ServiceCharge),a(".reviewRate").text("Rs. "+l(e.Rate)),a(".reviewTotal").text("Rs. "+l(e.Total)),a(".reviewName").text(e.Name),a(".reviewMobile").text(h(e.Mobile)),a(".reviewRecipientName").text(e.RecipientName),a(".reviewRecipientMobile").text(h(e.RecipientMobile)),a(".reviewInstructions").text(e.Instructions),a(".reviewReceiptNumber").text(e.TransactionRefNo)}function u(){return{Amount:a("#amount").val(),Email:a("#email").val(),Name:a("#name").val(),Mobile:a("#mobile").val(),RecipientName:a("#recipientName").val(),RecipientMobile:a("#recipientMobile").val(),Instructions:a("#instructions").val(),Declaration:a("#declaration").is(":checked"),Rate:n,Total:t,ServiceCharge:5}}function f(){a("#modalPleaseWait").modal("show")}function m(){a("#modalPleaseWait").modal("hide")}function h(e){if(!c(e))return null;for(var t="",n=e.length-1;0<=n;n--)3!=t.length&&7!=t.length||(t=" "+t),t=e[n]+t;return t}r(),a(window).scroll(r),a.ajax({url:"https://free.currencyconverterapi.com/api/v5/convert?q=AUD_NPR&compact=ultra"}).done(function(e){if(void 0!==e&&null!=e){var t=e.AUD_NPR;c(t)&&(t+=2,n=Math.round(100*t)/100,o())}}).fail(function(){alert("Sorry, we couldn't load today's exchange rate. As such we will not be able to process your request this time. Please try again later.")}),a("#amount").change(function(){o()}),a("#transferForm").submit(function(e){e.preventDefault();var t=u();c(t.Amount)&&c(t.Rate)&&c(t.Total)&&c(t.ServiceCharge)?(s(t),a("#modalConfirmPayment").modal("show")):alert("Sorry, unexpected error occurred.")}),a("#buttonCancelPay").click(function(e){m()}),a("#buttonPay").click(function(e){f();var r=u(),t={Amount:r.Amount,Reference:h(r.Mobile),Key:"1ef33243-96c8-44f9-abf7-8dfac14c3226"};a.ajax({contentType:"application/json",url:"https://money2nepal.azurewebsites.net/api/5ee2f588-8970-452c-9403-bf2b1af58cf4",data:JSON.stringify(t),type:"POST"}).done(function(e){if(0!=e.errorCode)alert("Sorry, we couldn't take you to POLi for the payments. Error code: "+e.errorCode),m();else{r.TransactionRefNo=e.transactionRefNo;var t=JSON.stringify(r),n=e.navigateURL.split("=");2!==n.length&&alert("Unexpected error occurred. Please contact support.");var a=n[1];sessionStorage.setItem(a,t),window.location.href=e.navigateURL}}).fail(function(){alert("Sorry, something went wrong processing your request."),m()})})}(jQuery);